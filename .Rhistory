fisher <- st_plot(fisher_null, title = "Fisher's sharp null")
ggarrange(pos, neg)
ggarrange(neyman, fisher)
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = rbinom(n, 1, 0.5))
pos_effect_t
data <- data %>%
mutate(y1_obs = ifelse(t==1, y1, NA_real_),
y0_obs = ifelse(t==0, y0, NA_real_))
data <- pos_effect_t
data <- data %>%
mutate(y1_obs = ifelse(t==1, y1, NA_real_),
y0_obs = ifelse(t==0, y0, NA_real_))
data
data <- data %>%
mutate(y1_obs = ifelse(t==1, y1, NA_real_),
y0_obs = ifelse(t==0, y0, NA_real_))
if (color == TRUE){
data <- mutate(data, color = y1 > y0)
data <- rbind(data, c(NA, NA, FALSE))
pbase <- ggplot(data, aes(x = y0, y = y1, color = color))
} else{
pbase <- ggplot(data, aes(x = y0, y = y1))
}
color = TRUE
if (color == TRUE){
data <- mutate(data, color = y1 > y0)
data <- rbind(data, c(NA, NA, FALSE))
pbase <- ggplot(data, aes(x = y0, y = y1, color = color))
} else{
pbase <- ggplot(data, aes(x = y0, y = y1))
}
plt <- pbase +
geom_hline(aes(y = y1_obs), alpha = 0.7, size = 0.8) +
geom_vline(aes(x = y0_obs), alpha = 0.7, size = 0.8) +
scale_color_manual(values = c("#DB4325", "#006164")) +
geom_abline(slope = 1, intercept = 0) +
xlim(c(0, 5)) + ylim(c(0, 5)) +
theme(axis.ticks = element_blank(), axis.text = element_blank(), legend.position = "none") +
ylab("Y(1)") +
xlab("Y(0)") +
coord_fixed()
plt
plt <- pbase +
geom_hline(aes(yintercept = y1_obs), alpha = 0.7, size = 0.8) +
geom_vline(aes(xintercept = y0_obs), alpha = 0.7, size = 0.8) +
scale_color_manual(values = c("#DB4325", "#006164")) +
geom_abline(slope = 1, intercept = 0) +
xlim(c(0, 5)) + ylim(c(0, 5)) +
theme(axis.ticks = element_blank(), axis.text = element_blank(), legend.position = "none") +
ylab("Y(1)") +
xlab("Y(0)") +
coord_fixed()
plt
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = rbinom(n, 1, 0.5))
fpci_plot <- function(data, color = TRUE, title = "") {
data <- data %>%
mutate(y1_obs = ifelse(t==1, y1, NA_real_),
y0_obs = ifelse(t==0, y0, NA_real_))
if (color == TRUE){
data <- mutate(data, color = y1 > y0)
data <- rbind(data, c(NA, NA, FALSE))
pbase <- ggplot(data, aes(x = y0, y = y1, color = color))
} else{
pbase <- ggplot(data, aes(x = y0, y = y1))
}
plt <- pbase +
geom_hline(aes(yintercept = y1_obs), alpha = 0.5, size = 0.8) +
geom_vline(aes(xintercept = y0_obs), alpha = 0.5, size = 0.8) +
scale_color_manual(values = c("#DB4325", "#006164")) +
geom_abline(slope = 1, intercept = 0) +
xlim(c(0, 5)) + ylim(c(0, 5)) +
theme(axis.ticks = element_blank(), axis.text = element_blank(), legend.position = "none") +
ylab("Y(1)") +
xlab("Y(0)") +
coord_fixed()
# special case if Fisher's null is true
if(all(data$y0 == data$y1, na.rm = TRUE)){
plt <- plt + scale_color_manual(values = "bisque4")
}
# add title if needed
if(!is.null(title)){
plt <- plt + ggtitle(title) + theme(plot.title = element_text(size = 10))
}
plt
}
library(ScienceTablePlots)
library(ScienceTablePlots)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(ggpubr)
library(ScienceTablePlots)
theme_set(theme_classic())
n <- 100
set.seed(123)
fpci_plot(pos_effect_t)
library(ScienceTablePlots)
library(ScienceTablePlots)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(ggpubr)
library(ScienceTablePlots)
theme_set(theme_classic())
n <- 100
set.seed(123)
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = rbinom(n, 1, 0.5))
fpci_plot(pos_effect_t)
fpci_plot()
?fpci_plot()
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = rbinom(n, 1, 0.5))
fpci_plot(pos_effect_t)
n <- 30
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = rbinom(n, 1, 0.5))
fpci_plot(pos_effect_t)
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(0,10), rep(1,10))))
fpci_plot(pos_effect_t)
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(0,10), rep(1,10))))
fpci_plot(pos_effect_t)
plt <- pbase +
geom_hline(alpha = 0.5, size = 0.8) +
geom_vline(alpha = 0.5, size = 0.8) +
scale_fill_manual(values = c("#DB4325", "#006164")) +
geom_abline(slope = 1, intercept = 0) +
xlim(c(0, 5)) + ylim(c(0, 5)) +
theme(axis.ticks = element_blank(), axis.text = element_blank(), legend.position = "none") +
ylab("Y(1)") +
xlab("Y(0)") +
coord_fixed()
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(0,10), rep(1,10))))
fpci_plot(pos_effect_t)
devtools::load_all()
install.packages(devtools)
install.packages("devtools")
devtools::load_all(".")
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(ggpubr)
library(ScienceTablePlots)
theme_set(theme_classic())
n <- 100
set.seed(123)
fpci_plot(pos_effect_t)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(ggpubr)
library(ScienceTablePlots)
theme_set(theme_classic())
n <- 100
set.seed(123)
toy_data <- data.frame(y0 = c(1, 4), y1 = c(3, 2),
barcolor = c("green", "red"), label = c("i", "j"))
b <- seq(0, 2*pi, by=0.001)
circ <- data.frame(y0=2.5*cos(b) + 2.5,
y1=2.5*sin(b) + 2.5)
circ_pos <- circ %>%
filter(y1>y0) %>%
mutate(circcolor = "green")
circ_neg <- circ %>%
filter(y0>y1) %>%
mutate(circcolor = "red")
schematic <- ggplot(toy_data, aes(x = y0, y = y1)) +
geom_polygon(dat = circ_pos, alpha = 0.1, fill = "#57C4AD") +
geom_polygon(dat = circ_neg, alpha = 0.1, fill = "#DB4325") +
geom_point() +
geom_text(aes(label = label), nudge_x = 0.1) +
geom_linerange(aes(ymin = y0, ymax = y1, color = barcolor))+
scale_color_manual(values = c("#006164", "#DB4325")) +
geom_segment(x = 0, y = 0, xend = 2, yend = 2) +
geom_segment(x = 3, y = 3, xend = 5, yend = 5) +
xlim(c(0, 5)) + ylim(c(0, 5)) +
theme(axis.ticks = element_blank(), axis.text = element_blank(), legend.position = "none") +
ylab("Y(1)") +
xlab("Y(0)") +
annotate("text", x = 2, y = 4, label = "Positive Effect", size= 5, color = "#006164") +
annotate("text", x = 3, y = 1, label = "Negative Effect", size= 5, color = "#DB4325") +
annotate("text", x = 2.5, y = 2.5, label = "No Effect", size= 5, angle = 45) +
annotate("text", x = 0.8, y = 2, label = expression(tau[i]), size= 6, parse = TRUE) +
annotate("text", x = 3.8, y = 3, label = expression(tau[j]), size= 6, parse = TRUE) +
coord_fixed()
schematic
pos_effect <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1))
neg_effect <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  -  1.25 + rnorm(n = n, sd = 0.1))
neyman_null <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0 + rnorm(n = n, sd = 0.25))
fisher_null <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0)
pos <- st_plot(pos_effect, title = "Positive effect")
neg <- st_plot(neg_effect, title = "Negative effect")
neyman <- st_plot(neyman_null, title = "Neyman's null")
fisher <- st_plot(fisher_null, title = "Fisher's sharp null")
ggarrange(pos, neg)
ggarrange(neyman, fisher)
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(0,10), rep(1,10))))
fpci_plot(pos_effect_t)
devtools::load_all(".")
fpci_plot(pos_effect_t)
devtools::load_all(".")
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(0,10), rep(1,10))))
fpci_plot(pos_effect_t)
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,10), rep(TRUE,10))))
fpci_plot(pos_effect_t)
y1_avg_obs = mean(data$y1_obs, na.rm = T)
devtools::load_all(".")
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,10), rep(TRUE,10))))
fpci_plot(pos_effect_t)
plt <- plt +
geom_hline(yintercept = y1_avg_obs, color = "black", size = 0.8) +
geom_vline(xintercept = y0_avg_obs, color = "black", size = 0.8)
devtools::load_all(".")
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,10), rep(TRUE,10))))
fpci_plot(pos_effect_t)
devtools::load_all(".")
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,10), rep(TRUE,10))))
fpci_plot(pos_effect_t)
devtools::load_all(".")
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,10), rep(TRUE,10))))
fpci_plot(pos_effect_t)
devtools::load_all(".")
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,10), rep(TRUE,10))))
fpci_plot(pos_effect_t)
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 1)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,10), rep(TRUE,10))))
fpci_plot(pos_effect_t)
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, sd =  1)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,10), rep(TRUE,10))))
fpci_plot(pos_effect_t)
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5, sd = 0.5)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,10), rep(TRUE,10))))
fpci_plot(pos_effect_t)
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5, sd = 0.4)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,10), rep(TRUE,10))))
fpci_plot(pos_effect_t)
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5, sd = 0.4)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,10), rep(TRUE,10))))
fpci_plot(pos_effect_t)
n <- 30
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5, sd = 0.4)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,10), rep(TRUE,10))))
n <- 20
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5, sd = 0.4)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(pos_effect_t)
n <- 100
pos_effect_t <- data.frame(y0 = rnorm(n = n, 2.5, sd = 0.4)) %>%
mutate(y1 = y0  +  1.25 + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(pos_effect_t)
n <- 100
rct_null <- data.frame(y0 = rnorm(n = n, 2.5, sd = 0.4)) %>%
mutate(y1 = y0  + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(pos_effect_t)
n <- 100
rct_null <- data.frame(y0 = rnorm(n = n, 2.5, sd = 0.4)) %>%
mutate(y1 = y0  + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(rct_null)
n <- 100
rct_null <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  + rnorm(n = n, sd = 0.1)) %>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(rct_null)
n <- 100
null <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  + rnorm(n = n, sd = 0.1))
rct_null <- null%>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(rct_null)
n <- 100
null <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  + rnorm(n = n, sd = 0.1))
rct_null <- null%>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(rct_null)
devtools::load_all(".")
n <- 100
null <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  + rnorm(n = n, sd = 0.1))
rct_null <- null%>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(rct_null)
devtools::load_all(".")
n <- 100
null <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0  + rnorm(n = n, sd = 0.1))
rct_null <- null%>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(rct_null)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-y0 - 2)))))
fpci_plot(null_biased up)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-y0 - 1)))))
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-y0)))))
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-y0 + 10)))))
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-y0 + 5)))))
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-y0 + 2)))))
fpci_plot(null_biased_up)
n <- 100
null <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0)
rct_null <- null%>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(rct_null)
n <- 100
null <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0)
rct_null <- null%>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(rct_null)
n <- 100
null <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0)
rct_null <- null%>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(rct_null)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-y0 + 2)))))
fpci_plot(null_biased_up)
mean(null_biased_up$t)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-y0 + 2)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-y0 + 2)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-y0 + 1)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-y0 + 2.5)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-y0 + 2.5)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2y0 + 2.5)))))
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 2.5)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 )))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 10)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 3)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 2)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 4)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 3.5)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 3)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 3)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 5)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 5)))))
null_biased_down <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(2*y0 - 5)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 5)))))
null_biased_down <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(2*y0 - 5)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
mean(null_biased_down$t)
fpci_plot(null_biased_down)
n <- 50
null <- data.frame(y0 = rnorm(n = n, 2.5)) %>%
mutate(y1 = y0)
rct_null <- null%>%
mutate(t = sample(c(rep(FALSE,n/2), rep(TRUE,n/2))))
fpci_plot(rct_null)
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 5)))))
null_biased_down <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(2*y0 - 5)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
mean(null_biased_down$t)
fpci_plot(null_biased_down)
devtools::load_all(".")
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 5)))))
null_biased_down <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(2*y0 - 5)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
devtools::load_all(".")
null_biased_up <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(-2*y0 + 5)))))
null_biased_down <- null %>%
mutate(t = as.logical(rbinom(n = n, size = 1, prob = 1 / (1 + exp(2*y0 - 5)))))
mean(null_biased_up$t)
fpci_plot(null_biased_up)
mean(null_biased_down$t)
fpci_plot(null_biased_down)
